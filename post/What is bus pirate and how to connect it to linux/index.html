<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>What is bus pirate and how to connect it to linux</title>

  <meta name="author" content="Vahid" />
  
  

  <meta name="generator" content="Hugo 0.16" />

  <link rel="alternate" href="https://vahidtaghiloo.github.io/index.xml" type="application/rss+xml" title="5 volts electronics">

  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://vahidtaghiloo.github.io/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://vahidtaghiloo.github.io/css/main.css" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="https://vahidtaghiloo.github.io/css/pygment_highlights.css" />
  
  
  <meta property="og:title" content="What is bus pirate and how to connect it to linux" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/" />
  <meta property="og:image" content="img/avatar-icon.png" />
  
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://vahidtaghiloo.github.io/">5 volts electronics</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
          <li>
          <a title="Blog" href="/">Blog</a>
  	      </li>
  	    
      
        
          <li>
          <a title="About" href="/page/about/">About</a>
  	      </li>
  	    
      
      </ul>
    </div>

	<div class="avatar-container">
	  <div class="avatar-img-border">
      
          <a title="5 volts electronics" href="https://vahidtaghiloo.github.io/">
              <img class="avatar-img" src="https://vahidtaghiloo.github.io/img/avatar-icon.png" alt="5 volts electronics" />
          </a>
      
	  </div>
	</div>

  </div>
</nav>


    <div role="main" class="container main-content">

      
        





<header class="header-section ">

<div class="intro-header no-img">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <h1>What is bus pirate and how to connect it to linux</h1>
      
      
      
      <span class="post-meta">Posted on August 10, 2016</span>
      
        </div>
      </div>
    </div>
  </div>
</div>
</header>




<div class="container">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
          

<p><img src="/img/bus-pirate.png" alt="bus-pirate" /></p>

<p>The bus pirate is an open source serial terminal bridge developed by <a href="http://dangerousprototypes.com">Dangerous Prototypes</a> that talks to electronic stuff through the serial port (or usb port). It supports variety of protocols like 1-wire, I2C, SPI, JTAG, asynchronous serial (UART), raw 2-wire and 3-wire and HD44780 LCD controller. The board is based on a PIC24F microcontroller and has different versions. the current recommended version is 3.6, there is also a version 4 and version 5 (not fully developed yet). The represented numbers on the pictur are:</p>

<ol>
<li>mini USB port</li>
<li>USB RX/TX LED indicator</li>
<li>Power indicator LED (probably green)</li>
<li>Mode indicator LED</li>
<li>Voltage regulator indicator LED</li>
<li>Output connector (2X5 IDC connector)</li>
<li>PIC programming connector (in case something goes wrong, probably you won&rsquo;t use it at all)</li>
</ol>

<h2 id="working-with-bus-pirate">Working with bus pirate</h2>

<p>OK, first you should get a bus pirate board. You can buy it from Dangerous Prototypes or their vendors, you can get a free pcb (parts not included) again from Dangerous Prototypes or you can make your own board because the schematic and pcb are available. I couldn&rsquo;t buy it so I decided to make the pcb myself. As you see in the picture it is a bit different from the original one because I wanted to easily hand solder it so I used larger packages for parts.</p>

<p>bus pirate talks to your computer via a FTDI USB to UART interface IC. We type commands into a serial terminal on the computer, the commands go to the bus pirate, it communicates to the outside world in the selected protocol (based on the commands we typed earlier) and returns result to the pc.</p>

<p>bus pirate has two modes :</p>

<ol>
<li>User Terminal mode (user types all the commands himself)</li>
<li>Binary Scripting Mode (work is done automatically with python or perl scripts)</li>
</ol>

<p>In these series of tutorials we use the first method. for more information on binary mode visit <a href="https://learn.sparkfun.com/tutorials/bus-pirate-v36a-hookup-guide#bsm">Bus Pirate v3.6a Hookup Guide</a></p>

<p>Because bus pirate has a serial interface, it works with many platforms, pc, mac, linux, even android. My main os is debian so I&rsquo;m using it. We also need a terminal emulator. In linux world there are some choices : screen, miniterm, minicom, picocom, &hellip;. In most distros screen is already installed. If not, use <code>$sudo apt-get install screen</code> , or use whatever package manager your distro has. For the first step we want to know if bus pirate works correctly or not. The bus pirate firmware has a self test mode. connect the board to the usb port and see if it is recognized. For instance in my laptop :</p>

<pre><code>$lsusb
Bus 002 Device 002: ID 05ac:8406 Apple, Inc.
Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub
Bus 001 Device 003: ID 05ac:0291 Apple, Inc.
Bus 001 Device 006: ID 05ac:828f Apple, Inc.
Bus 001 Device 002: ID 0a5c:4500 Broadcom Corp. BCM2046B1 USB 2.0 Hub (part of BCM2046 Bluetooth)
Bus 001 Device 007: ID 0403:6001 Future Technology Devices International, Ltd FT232 USB-Serial (UART) IC
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
</code></pre>

<p>See that a Future Technology Device FT232 USB-Serial (UART) is recognized by pc. The first serial device connected to linux is named ttyUSB0 or in some distros ttyACM0, obviously the next serial device would be ttyUSB1 and so on. To find out the serial device name type <code>$sudo cat /var/log/messages | tail</code> in the terminal or simply type <code>$dmesg | tail</code></p>

<pre><code>$sudo cat /var/log/messages | tail
Aug 10 18:02:37 debian kernel: [ 2445.106227] usbserial: USB Serial support registered for generic
Aug 10 18:02:37 debian kernel: [ 2445.111095] usbcore: registered new interface driver ftdi_sio
Aug 10 18:02:37 debian kernel: [ 2445.111125] usbserial: USB Serial support registered for FTDI USB Serial Device
Aug 10 18:02:37 debian kernel: [ 2445.111340] ftdi_sio 1-1:1.0: FTDI USB Serial Device converter detected
Aug 10 18:02:37 debian kernel: [ 2445.111453] usb 1-1: Detected FT232RL
Aug 10 18:02:37 debian kernel: [ 2445.111460] usb 1-1: Number of endpoints 2
Aug 10 18:02:37 debian kernel: [ 2445.111467] usb 1-1: Endpoint 1 MaxPacketSize 64
Aug 10 18:02:37 debian kernel: [ 2445.111473] usb 1-1: Endpoint 2 MaxPacketSize 64
Aug 10 18:02:37 debian kernel: [ 2445.111479] usb 1-1: Setting MaxPacketSize 64
Aug 10 18:02:37 debian kernel: [ 2445.111842] usb 1-1: FTDI USB Serial Device converter now attached to ttyUSB0
</code></pre>

<pre><code>$dmesg | tail
[ 2445.106227] usbserial: USB Serial support registered for generic
[ 2445.111095] usbcore: registered new interface driver ftdi_sio
[ 2445.111125] usbserial: USB Serial support registered for FTDI USB Serial Device
[ 2445.111340] ftdi_sio 1-1:1.0: FTDI USB Serial Device converter detected
[ 2445.111453] usb 1-1: Detected FT232RL
[ 2445.111460] usb 1-1: Number of endpoints 2
[ 2445.111467] usb 1-1: Endpoint 1 MaxPacketSize 64
[ 2445.111473] usb 1-1: Endpoint 2 MaxPacketSize 64
[ 2445.111479] usb 1-1: Setting MaxPacketSize 64
[ 2445.111842] usb 1-1: FTDI USB Serial Device converter now attached to ttyUSB0
</code></pre>

<p>Both commands show that ftdi is connected to ttyUSB0. Now type <code>$sudo screen /dev/ttyUSB0 115200 8N1</code> and hit enter 2 times. Immediately terminal shows a prompt screen like bellow waiting for commands.</p>

<pre><code>$sudo screen /dev/ttyUSB0 115200 8N1
HiZ&gt;
</code></pre>

<p>The initial mode of bus pirate is HiZ (hi impedance) and It means all the inputs are disabled for protection. If you have come this far, probably bus pirate works correctly. The commands are fairly simple: i shows information (firmware version, device id, &hellip;) about bus pirate, ? shows a detailed help menu and m changes bus pirate mode.</p>

<pre><code>HiZ&gt;i
Bus Pirate v3.5
Firmware v6.2-beta1 r1981  Bootloader v4.4
DEVID:0x0447 REVID:0x3046 (24FJ64GA002 B8)
http://dangerousprototypes.com
HiZ&gt;?
 General                                        Protocol interaction
 ---------------------------------------------------------------------------
 ?      This help                       (0)     List current macros
 =X/|X  Converts X/reverse X            (x)     Macro x
 ~      Selftest                        [       Start
 #      Reset the BP                    ]       Stop
 $      Jump to bootloader              {       Start with read
 &amp;/%    Delay 1 us/ms                   }       Stop
 a/A/@  AUXPIN (low/HI/READ)            &quot;abc&quot;   Send string
 b      Set baudrate                    123
 c/C    AUX assignment (aux/CS)         0x123
 d/D    Measure ADC (once/CONT.)        0b110   Send value
 f      Measure frequency               r       Read
 g/S    Generate PWM/Servo              /       CLK hi
 h      Commandhistory                  \       CLK lo
 i      Versioninfo/statusinfo          ^       CLK tick
 l/L    Bitorder (msb/LSB)              -       DAT hi
 m      Change mode                     _       DAT lo
 o      Set output type                 .       DAT read
 p/P    Pullup resistors (off/ON)       !       Bit read
 s      Script engine                   :       Repeat e.g. r:10
 v      Show volts/states               ;       Bits to read/write e.g. 0x55;2
 w/W    PSU (off/ON)            &lt;x&gt;/&lt;x= &gt;/&lt;0&gt;   Usermacro x/assign x/list all
HiZ&gt;
</code></pre>

<p>To self-test the bus pirate, just connect jumpers to the output connector according to the picture and then type ~ (tilda) character in bus pirate command prompt and hit space key to continue.</p>

<p><img src="/img/bus-pirate-selftest.png" alt="bus-pirate-selftest" /></p>

<pre><code>MODE LED OK
PULLUP H OK
PULLUP L OK
VREG OK
ADC and supply
5V(4.93) OK
VPU(4.93) OK
3.3V(3.21) OK
ADC(3.20) OK
Bus high
MOSI OK
CLK OK
MISO OK
CS OK
Bus Hi-Z 0
MOSI OK
CLK OK
MISO OK
CS OK
Bus Hi-Z 1
MOSI OK
CLK OK
MISO OK
CS OK
MODE and VREG LEDs should be on!
Any key to exit
Found 0 errors.
</code></pre>

<p>Well, everything seems OK. To exit screen session hit ctrl+a and then ctrl+d.</p>

<p><strong>note:</strong> <em>as you see copying and pasting terminal output is really ugly and unnecessary, so in the next series of tutorials I will record screencasts instead.</em></p>

<p><strong>update</strong> Now you can watch the asciicast for this tutorial.</p>

<script type="text/javascript" src="https://asciinema.org/a/b0dwoat6ylpe055749bwffq6p.js" id="asciicast-b0dwoat6ylpe055749bwffq6p" async></script>

      </article>

      <ul class="pager blog-pager">
        
        <li class="previous">
          <a href="https://vahidtaghiloo.github.io/post/First%20post%20on%20my%20blog/" data-toggle="tooltip" data-placement="top" title="First post on my blog">&larr; Previous Post</a>
        </li>
        
        
        <li class="next">
          <a href="https://vahidtaghiloo.github.io/post/Set%20udev%20rules%20for%20bus%20pirate%20on%20Linux/" data-toggle="tooltip" data-placement="top" title="Set udev rules for bus pirate on Linux">Next Post &rarr;</a>
        </li>
        
      </ul>

      

    </div>
  </div>
</div>

      

    </div>

    <footer>
  <div class="container beautiful-jekyll-footer">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
          <li>
            <a href="https://github.com/vahidtaghiloo" title="GitHub">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		      
		      
          <li>
            <a href="mailto:v.taghiloo@gmail.com" title="Email me">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		      
	    	  
          
          

    		  <li>
      			<a href="https://vahidtaghiloo.github.io/index.xml" title="RSS">
      			  <span class="fa-stack fa-lg">
        				<i class="fa fa-circle fa-stack-2x"></i>
        				<i class="fa fa-rss fa-stack-1x fa-inverse"></i>
      			  </span>
      			</a>
    		  </li>		

        </ul>
        <p class="copyright text-muted">
    		  Vahid
    		  &nbsp;&bull;&nbsp;
    		  2016
    		  
    		  
    		  &nbsp;&bull;&nbsp;
    		  <a href="https://vahidtaghiloo.github.io/">5 volts electronics</a>
    		  
  	    </p>
  	        
    		<p class="theme-by text-muted">
    		  Theme by
    		  <a href="http://deanattali.com/beautiful-jekyll/">beautiful-jekyll</a>
    		</p>
      </div>
    </div>
  </div>
</footer>

<script src="https://vahidtaghiloo.github.io/js/jquery-1.11.2.min.js"></script>
<script src="https://vahidtaghiloo.github.io/js/bootstrap.min.js"></script>
<script src="https://vahidtaghiloo.github.io/js/main.js"></script>



  </body>
</html>
